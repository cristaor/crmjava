<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="es">
<head>
<!-- Generated by javadoc (version 1.7.0) on Thu Mar 22 08:36:25 CET 2012 -->
<title>TEA</title>
<meta name="date" content="2012-03-22">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="TEA";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/knowgate/misc/NameValuePair.html" title="class in com.knowgate.misc"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../com/knowgate/misc/Thumbnail.html" title="class in com.knowgate.misc"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/knowgate/misc/TEA.html" target="_top">Frames</a></li>
<li><a href="TEA.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.knowgate.misc</div>
<h2 title="Class TEA" class="title">Class TEA</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.knowgate.misc.TEA</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">TEA</span>
extends java.lang.Object</pre>
<div class="block">Tiny Encryption Algorithm.
 <P>
 (The following description is from the web page for the C and Assembler source
 code at <A HREF="http://vader.brad.ac.uk/tea/tea.shtml"> University of Bradford
 Yorkshire, England - The Cryptography & Computer Communications Security
 Group</A>) The description is used with the permission of the authors,
 Dr S J Shepherd and D A G Gillies.
 <P>
 The Tiny Encryption Algorithm is one of the fastest and most efficient
 cryptographic algorithms in existence. It was developed by David
 Wheeler and Roger Needham at the Computer Laboratory of Cambridge
 University. It is a Feistel cipher which uses operations from mixed
 (orthogonal) algebraic groups - XORs and additions in this case. It
 encrypts 64 data bits at a time using a 128-bit key. It seems highly
 resistant to differential cryptanalysis, and achieves complete
 diffusion (where a one bit difference in the plaintext will cause
 approximately 32 bit differences in the ciphertext) after only six
 rounds. Performance on a modern desktop computer or workstation is
 very impressive.
 <P>
 TEA takes 64 bits of data in v[0] and v[1], and 128 bits of key in
 k[0] - k[3]. The result is returned in w[0] and w[1]. Returning the
 result separately makes implementation of cipher modes other than
 Electronic Code Book a little bit easier.
 <P>
 TEA can be operated in any of the modes of DES.
 <P>
 n is the number of iterations. 32 is ample, 16 is sufficient, as few
 as eight should be OK for most applications, especially ones where
 the data age quickly (real-time video, for example). The algorithm
 achieves good dispersion after six iterations. The iteration count
 can be made variable if required.
 <P>
 Note this algorithm is optimised for 32-bit CPUs with fast shift
 capabilities. It can very easily be ported to assembly language on
 most CPUs.
 <P>
 delta is chosen to be the Golden ratio ((5/4)1/2 - 1/2 ~ 0.618034)
 multiplied by 232. On entry to decipher(), sum is set to be delta *
 n. Which way round you call the functions is arbitrary: DK(EK(P)) =
 EK(DK(P)) where EK and DK are encryption and decryption under key K
 respectively.
 <P>
 Translator's notes:
 <UL>
 <LI> Although the <I>this algorithm is optimised for
 32-bit CPUs with fast shift capabilities</I> Java manages to throw
 it all away by not providing unsigned values resulting in the excessive
 use of AND's to prevent sign extension on promotion of a byte
 to an integer.
 </LI>
 <P>
 <LI>
 The following description is taken from the
 Mach5 Software cryptography archives at
 <A HREF="http://www.mach5.com/crypto/">www.mach5.com/crypto</A>.
 <p><font face="Arial" size="4">Tiny Encryption Algorithm (TEA)</font><br>
 <font size="3" face="Arial">TEA is a cryptographic algorithm designed to minimize memory
 footprint, and maximize speed. However, the cryptographers from <a

 href="http://www.counterpane.com">Counterpane Systems</a> have <a

 href="http://www.cs.berkeley.edu/~daw/keysched-crypto96.ps">discovered three related-key
 attacks </a>on TEA, the best of which requires only 223 chosen plaintexts and one related
 key query. The problems arise from the overly simple key schedule. Each TEA key can be
 found to have three other equivalent keys, as described in <a

 href="http://www.cs.berkeley.edu/~daw/keysched-icics97.ps">a paper</a> by <a

 href="http://www.cs.berkeley.edu/~daw/">David Wagner</a>, John Kelsey, and <a

 href="http://www.counterpane.com/schneier.html">Bruce Schneier</a>. This precludes the
 possibility of using TEA as a hash function. Roger Needham and David Wheeler have proposed
 <a href="http://www.cl.cam.ac.uk/ftp/users/djw3/xtea.ps">extensions to TEA</a> that
 counters the above attacks.</font></p>
 </LI>
 </UL>

 <P> Example of use:
 <PRE>
 byte key[] = new BigInteger("39e858f86df9b909a8c87cb8d9ad599", 16).toByteArray();
 TEA t = new TEA(key);
 <BR>
 String src = "hello world!";
 System.out.println("input = " + src);
 byte plainSource[] = src.getBytes();
 int enc[] = t.encode(plainSource, plainSource.length);
 System.out.println(t.padding() + " bytes added as padding.");
 byte dec[] = t.decode(enc);
 System.out.println("output = " + new String(dec));
 </PRE></div>
<dl><dt><span class="strong">Since:</span></dt>
  <dd>JDK1.1</dd>
<dt><span class="strong">Version:</span></dt>
  <dd>1.0 Sep 8, 1998</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../com/knowgate/misc/TEA.html#TEA(byte[])">TEA</a></strong>(byte[]&nbsp;key)</code>
<div class="block">Accepts key for enciphering/deciphering.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../com/knowgate/misc/TEA.html#decipher(byte[])">decipher</a></strong>(byte[]&nbsp;v)</code>
<div class="block">Decipher two <code>bytes</code>s.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int[]</code></td>
<td class="colLast"><code><strong><a href="../../../com/knowgate/misc/TEA.html#decipher(int[])">decipher</a></strong>(int[]&nbsp;v)</code>
<div class="block">Decipher two <code>int</code>s.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../com/knowgate/misc/TEA.html#decode(byte[], int)">decode</a></strong>(byte[]&nbsp;b,
      int&nbsp;count)</code>
<div class="block">Convert a byte array to ints and then decode.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../com/knowgate/misc/TEA.html#decode(int[])">decode</a></strong>(int[]&nbsp;b)</code>
<div class="block">Decode an integer array.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><strong><a href="../../../com/knowgate/misc/TEA.html#encipher(byte[])">encipher</a></strong>(byte[]&nbsp;v)</code>
<div class="block">Encipher two <code>bytes</code>s.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int[]</code></td>
<td class="colLast"><code><strong><a href="../../../com/knowgate/misc/TEA.html#encipher(int[])">encipher</a></strong>(int[]&nbsp;v)</code>
<div class="block">Encipher two <code>int</code>s.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int[]</code></td>
<td class="colLast"><code><strong><a href="../../../com/knowgate/misc/TEA.html#encode(byte[], int)">encode</a></strong>(byte[]&nbsp;b,
      int&nbsp;count)</code>
<div class="block">Byte wrapper for encoding.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../com/knowgate/misc/TEA.html#main(java.lang.String[])">main</a></strong>(java.lang.String[]&nbsp;args)</code>
<div class="block">Encodes and decodes "Hello world!"</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../com/knowgate/misc/TEA.html#padding()">padding</a></strong>()</code>
<div class="block">Report how much padding was done in the last encode.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../com/knowgate/misc/TEA.html#toString()">toString</a></strong>()</code>
<div class="block">Representation of TEA class</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="TEA(byte[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>TEA</h4>
<pre>public&nbsp;TEA(byte[]&nbsp;key)</pre>
<div class="block">Accepts key for enciphering/deciphering.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>key</code> - 128 bit (16 byte) key.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.ArrayIndexOutOfBoundsException</code> - if the key isn't the correct length.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="main(java.lang.String[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;args)</pre>
<div class="block">Encodes and decodes "Hello world!" for your personal pleasure.</div>
</li>
</ul>
<a name="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;java.lang.String&nbsp;toString()</pre>
<div class="block">Representation of TEA class</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code>toString</code>&nbsp;in class&nbsp;<code>java.lang.Object</code></dd>
</dl>
</li>
</ul>
<a name="encipher(int[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encipher</h4>
<pre>public&nbsp;int[]&nbsp;encipher(int[]&nbsp;v)</pre>
<div class="block">Encipher two <code>int</code>s.
 Replaces the original contents of the parameters with the results.
 The integers are usually created from 8 bytes.
 The usual way to collect bytes to the int array is:
 <PRE>
 byte ba[] = { .... };
 int v[] = new int[2];
 v[0] = (ba[j] << 24 ) | (((ba[j+1])&0xff) << 16) | (((ba[j+2])&0xff) << 8) | ((ba[j+3])&0xff);
 v[1] = (ba[j+4] << 24 ) | (((ba[j+5])&0xff) << 16) | (((ba[j+6])&0xff) << 8) | ((ba[j+7])&0xff);
 v = encipher(v);
 </PRE></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>v</code> - two <code>int</code> array as input.</dd>
<dt><span class="strong">Returns:</span></dt><dd>array of two <code>int</code>s, enciphered.</dd></dl>
</li>
</ul>
<a name="decipher(int[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decipher</h4>
<pre>public&nbsp;int[]&nbsp;decipher(int[]&nbsp;v)</pre>
<div class="block">Decipher two <code>int</code>s.
 Replaces the original contents of the parameters with the results.
 The integers are usually decocted to 8 bytes.
 The decoction of the <code>int</code>s to bytes can be done
 this way.
 <PRE>
 int x[] = decipher(ins);
 outb[j]   = (byte)(x[0] >>> 24);
 outb[j+1] = (byte)(x[0] >>> 16);
 outb[j+2] = (byte)(x[0] >>> 8);
 outb[j+3] = (byte)(x[0]);
 outb[j+4] = (byte)(x[1] >>> 24);
 outb[j+5] = (byte)(x[1] >>> 16);
 outb[j+6] = (byte)(x[1] >>> 8);
 outb[j+7] = (byte)(x[1]);
 </PRE></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>v</code> - <code>int</code> array of 2</dd>
<dt><span class="strong">Returns:</span></dt><dd>deciphered <code>int</code> array of 2</dd></dl>
</li>
</ul>
<a name="encipher(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encipher</h4>
<pre>public&nbsp;byte[]&nbsp;encipher(byte[]&nbsp;v)</pre>
<div class="block">Encipher two <code>bytes</code>s.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>v</code> - <code>byte</code> array of 2</dd>
<dt><span class="strong">Returns:</span></dt><dd>enciphered <code>byte</code> array of 2</dd></dl>
</li>
</ul>
<a name="decipher(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decipher</h4>
<pre>public&nbsp;byte[]&nbsp;decipher(byte[]&nbsp;v)</pre>
<div class="block">Decipher two <code>bytes</code>s.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>v</code> - <code>byte</code> array of 2</dd>
<dt><span class="strong">Returns:</span></dt><dd>decipherd <code>byte</code> array of 2</dd></dl>
</li>
</ul>
<a name="encode(byte[], int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encode</h4>
<pre>public&nbsp;int[]&nbsp;encode(byte[]&nbsp;b,
           int&nbsp;count)</pre>
<div class="block">Byte wrapper for encoding.
 Converts bytes to ints.
 Padding will be added if required.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>b</code> - incoming <code>byte</code> array</dd><dd><code>byte</code> - count</dd>
<dt><span class="strong">Returns:</span></dt><dd>integer conversion array, possibly with padding.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/knowgate/misc/TEA.html#padding()"><code>padding()</code></a></dd></dl>
</li>
</ul>
<a name="padding()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>padding</h4>
<pre>public&nbsp;int&nbsp;padding()</pre>
<div class="block">Report how much padding was done in the last encode.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>bytes of padding added</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../com/knowgate/misc/TEA.html#encode(byte[], int)"><code>encode(byte[], int)</code></a></dd></dl>
</li>
</ul>
<a name="decode(byte[], int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decode</h4>
<pre>public&nbsp;byte[]&nbsp;decode(byte[]&nbsp;b,
            int&nbsp;count)</pre>
<div class="block">Convert a byte array to ints and then decode.
 There may be some padding at the end of the byte array from
 the previous encode operation.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>b</code> - bytes to decode</dd><dd><code>count</code> - number of bytes in the array to decode</dd>
<dt><span class="strong">Returns:</span></dt><dd><code>byte</code> array of decoded bytes.</dd></dl>
</li>
</ul>
<a name="decode(int[])">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>decode</h4>
<pre>public&nbsp;byte[]&nbsp;decode(int[]&nbsp;b)</pre>
<div class="block">Decode an integer array.
 There may be some padding at the end of the byte array from
 the previous encode operation.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>b</code> - bytes to decode</dd><dd><code>count</code> - number of bytes in the array to decode</dd>
<dt><span class="strong">Returns:</span></dt><dd><code>byte</code> array of decoded bytes.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../com/knowgate/misc/NameValuePair.html" title="class in com.knowgate.misc"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../com/knowgate/misc/Thumbnail.html" title="class in com.knowgate.misc"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?com/knowgate/misc/TEA.html" target="_top">Frames</a></li>
<li><a href="TEA.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
